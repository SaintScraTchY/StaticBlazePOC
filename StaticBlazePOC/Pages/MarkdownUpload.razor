@page "/markdown-upload"
@using StaticBlazePOC.Models
@inject GitHubService GitHubService

<h3>Upload Markdown</h3>

<EditForm Model="@textGit" OnValidSubmit="UploadMarkdown">
    <InputText @bind-Value="@textGit.GitFilePath" placeholder="File Path (e.g., posts/test.md)" />
    <br/>
    <InputTextArea @bind-Value="@textGit.MarkdownContent" placeholder="Markdown Content" />
    <br/>
    <InputText @bind-Value="@textGit.GitHubPat" placeholder="GitHub PAT" />
    <br/>
    <InputText @bind-Value="@textGit.GitRepo" placeholder="GitHub Repo" />
    <br/>
    <InputText @bind-Value="@textGit.GitAccount" placeholder="GitHub UserName" />
    <button type="submit">Upload</button>
</EditForm>

@code {

    private TextGitUploadModel textGit = new TextGitUploadModel()
    {
        GitAccount = "your-github-account",
        GitRepo = "your-github-repo",
        GitFilePath = "posts/test.md",
        GitHubPat = "your-github-pat",
        MarkdownContent = "# Hello, Markdown!"
    };

    private async Task UploadMarkdown()
    {
        try
        {
            await GitHubService.PushMarkdownFile(textGit.GitAccount, textGit.GitRepo, textGit.GitFilePath, textGit.MarkdownContent, textGit.GitHubPat);
            Console.WriteLine("Markdown uploaded successfully!");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error: {ex.Message}");
        }
    }

}